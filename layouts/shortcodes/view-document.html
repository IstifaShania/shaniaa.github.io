{{ $path := .Get 0 }}
{{ $type := .Get 1 | default "pdf" }}

<div class="document-viewer">
  {{ if eq $type "pdf" }}
    <object 
      data="{{ $path }}"
      type="application/pdf"
      width="100%"
      height="600px"
      style="border: 1px solid #ddd;">
      <div class="fallback">
        <p>Tampaknya browser Anda tidak dapat menampilkan PDF secara langsung.</p>
        <p>Anda dapat <a href="{{ $path }}" target="_blank">membuka file PDF di tab baru</a> untuk melihatnya.</p>
      </div>
    </object>
  {{ else if eq $type "ppt" }}
    <div class="ppt-container" style="position: relative; width: 100%; height: 600px; overflow: hidden; border: 1px solid #ddd;">
      <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: 2; background: transparent;"></div>
      <iframe 
        src="https://view.officeapps.live.com/op/embed.aspx?src={{ .Site.BaseURL }}{{ $path }}" 
        width="100%" 
        height="100%" 
        style="border: none;">
        <p>Browser Anda tidak mendukung iframe.</p>
      </iframe>
    </div>
  {{ end }}
</div>

<style>
  .document-viewer {
    position: relative;
    margin: 20px 0;
  }
  
  /* Overlay untuk mencegah tindakan tertentu */
  .document-viewer::after {
    content: "";
    position: absolute;
    top: 0;
    right: 0;
    width: 40px;
    height: 40px;
    z-index: 10;
    background-color: transparent;
    pointer-events: none;
  }
</style>
